-- üîß Config
local config = {
    remoteURL = "https://raw.githubusercontent.com/g00glesucksdude-oss/Evade-Injector/main/",
    debug = false
}

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- üéÆ GUI Setup
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "EvadeInjector"

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 400, 0, 250)
frame.Position = UDim2.new(0.5, -200, 0.5, -125)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.Active = true
frame.Draggable = true

local title = Instance.new("TextLabel", frame)
title.Size = UDim2.new(1, -60, 0, 40)
title.Position = UDim2.new(0, 10, 0, 0)
title.Text = "Evade Injector"
title.Font = Enum.Font.GothamBold
title.TextSize = 24
title.BackgroundTransparency = 1

local function animateRGB(label)
    local hue = 0
    RunService.RenderStepped:Connect(function()
        hue = (hue + 0.01) % 1
        label.TextColor3 = Color3.fromHSV(hue, 1, 1)
    end)
end
animateRGB(title)

-- üîò Close + Minimize
local close = Instance.new("TextButton", frame)
close.Text = "‚úï"
close.Size = UDim2.new(0, 25, 0, 25)
close.Position = UDim2.new(1, -30, 0, 5)
close.BackgroundColor3 = Color3.fromRGB(60, 0, 0)
close.MouseButton1Click:Connect(function() gui:Destroy() end)

local minimize = Instance.new("TextButton", frame)
minimize.Text = "‚Äî"
minimize.Size = UDim2.new(0, 25, 0, 25)
minimize.Position = UDim2.new(1, -60, 0, 5)
minimize.BackgroundColor3 = Color3.fromRGB(0, 60, 60)
local minimized = false
minimize.MouseButton1Click:Connect(function()
    minimized = not minimized
    for _, obj in pairs(frame:GetChildren()) do
        if obj ~= title and obj ~= close and obj ~= minimize then
            obj.Visible = not minimized
        end
    end
    frame.Size = minimized and UDim2.new(0, 400, 0, 50) or UDim2.new(0, 400, 0, 250)
end)

-- üî£ Inputs
local input = Instance.new("TextBox", frame)
input.PlaceholderText = "Paste Gatekeeper key here"
input.Size = UDim2.new(1, -20, 0, 30)
input.Position = UDim2.new(0, 10, 0, 50)

local validate = Instance.new("TextButton", frame)
validate.Text = "Validate"
validate.Size = UDim2.new(0.5, -15, 0, 30)
validate.Position = UDim2.new(0, 10, 0, 90)

local redeemLabel = Instance.new("TextLabel", frame)
redeemLabel.Size = UDim2.new(1, -20, 0, 30)
redeemLabel.Position = UDim2.new(0, 10, 0, 130)

local validityLabel = Instance.new("TextLabel", frame)
validityLabel.Size = UDim2.new(1, -20, 0, 30)
validityLabel.Position = UDim2.new(0, 10, 0, 160)

-- üçΩÔ∏è Emoji Digit Map
local CJK = {"(",")","^","$","%","@","!","#","&","*"}
local REVERSE = {}
for i, v in ipairs(CJK) do REVERSE[v] = i - 1 end

local function debug(msg)
    if config.debug then print("[EvadeInjector] " .. msg) end
end

local function reverseDigits(symbols, shift)
    local digits = {}
    for i = 1, #symbols do
        local char = symbols:sub(i,i)
        local val = REVERSE[char]
        if not val then return nil end
        local d = (val - shift) % 10
        table.insert(digits, tostring(d))
    end
    return tonumber(table.concat(digits))
end

local function decodeKeyword(symbols, shift)
    local digits = {}
    for i = 1, #symbols do
        local char = symbols:sub(i,i)
        local val = REVERSE[char]
        if not val then return nil end
        local d = (val - shift) % 10
        table.insert(digits, tostring(d))
    end
    local keyword = ""
    for i = 1, #digits, 2 do
        local pair = digits[i] .. (digits[i+1] or "0")
        local num = tonumber(pair)
        if num then
            keyword = keyword .. string.char((num - 1) + 65)
        end
    end
    return keyword:lower()
end

-- üóÇÔ∏è Nonce Tracker
local registryFile = "nonce_registry.txt"
local nonceFileName
if isfile(registryFile) then
    nonceFileName = readfile(registryFile)
else
    nonceFileName = "nonce_" .. tostring(math.random(100000, 999999)) .. ".txt"
    writefile(registryFile, nonceFileName)
end

local usedNonces = {}
if isfile(nonceFileName) then
    for line in string.gmatch(readfile(nonceFileName), "[^\r\n]+") do
        usedNonces[tonumber(line)] = true
    end
end

-- üîò Validate Logic
validate.MouseButton1Click:Connect(function()
    local raw = input.Text
    local parts = string.split(raw, "_")
    if #parts < 5 then
        redeemLabel.Text = "‚ùå Invalid key format"
        return
    end

    local shift = tonumber(string.match(raw, ":(%d+)"))
    if not shift then
        redeemLabel.Text = "‚ùå Missing Caesar shift"
        return
    end

    local validFrom = reverseDigits(parts[1], shift)
    local validUntil = reverseDigits(parts[2], shift)
    local expireAt  = reverseDigits(parts[3], shift)
    local nonce     = reverseDigits(parts[4], shift)
    local keyword   = decodeKeyword(parts[5]:match("([^:]+)"), shift)

    if not validFrom or not validUntil or not expireAt or not nonce or not keyword then
        redeemLabel.Text = "‚ùå Key decode failed"
        return
    end

    if usedNonces[nonce] then
        redeemLabel.Text = "‚ùå Nonce already used"
        return
    end
    usedNonces[nonce] = true
    appendfile(nonceFileName, tostring(nonce) .. "\n")

    local shutdownFlag = "shutdownflag_" .. keyword
    getgenv()[shutdownFlag] = false

    local now = os.time()

    if now < validFrom then
        redeemLabel.Text = "‚ùå Key not yet redeemable"
        return
    end

    if now > validUntil then
        redeemLabel.Text = "‚ùå Redeem window closed"
        return
    end

    if now > expireAt then
        validityLabel.Text = "‚ùå Key expired"
        getgenv()[shutdownFlag] = true
        return
    end

    redeemLabel.Text = "‚úÖ Key accepted"

    -- ‚è≥ Live countdowns
    task.spawn(function()
        while os.time() < validUntil do
            local left = validUntil - os.time()
            redeemLabel.Text = "Redeem time left: " .. left .. "s"
            task.wait(1)
        end
        redeemLabel.Text = "‚ùå Redeem window closed"
    end)

    task.spawn(function()
        while os.time() < expireAt do
            local left = expireAt - os.time()
            validityLabel.Text = "Expiry in: " .. left .. "s"
            task.wait(1)
        end
        validityLabel.Text = "‚ùå Key expired"
        getgenv()[shutdownFlag] = true
    end)

    -- üõ∞Ô∏è Remote Loader
    local url = config.remoteURL .. keyword .. ".lua"
    local success, result = pcall(function()
        return game:HttpGet(url)
    end)

    if success then
        local ok, err = pcall(function()
            loadstring(result)()
        end)
        if not ok then
                        redeemLabel.Text = "‚ùå Script execution error"
        end
    else
        redeemLabel.Text = "‚ùå Script load failed"
    end
end)
